# Описание
**Проект YaMDb** собирает отзывы пользователей на различные произведения.  

## Алгоритм регистрации пользователей
1. Пользователь отправляет POST-запрос на добавление нового пользователя с параметрами email и username на эндпоинт /api/v1/auth/signup/.
2. YaMDB отправляет письмо с кодом подтверждения (confirmation_code) на адрес email.
3. Пользователь отправляет POST-запрос с параметрами username и confirmation_code на эндпоинт /api/v1/auth/token/, в ответе на запрос ему приходит token (JWT-токен).
4. При желании пользователь отправляет PATCH-запрос на эндпоинт /api/v1/users/me/ и заполняет поля в своём профайле (описание полей — в документации).

## Пользовательские роли
* Аноним — может просматривать описания произведений, читать отзывы и комментарии.
* Аутентифицированный пользователь (user) — может, как и Аноним, читать всё, дополнительно он может публиковать отзывы и ставить оценку произведениям (фильмам/книгам/песенкам), может комментировать чужие отзывы; может редактировать и удалять свои отзывы и комментарии. Эта роль присваивается по умолчанию каждому новому пользователю.
* Модератор (moderator) — те же права, что и у Аутентифицированного пользователя плюс право удалять любые отзывы и комментарии.
* Администратор (admin) — полные права на управление всем контентом проекта. Может создавать и удалять произведения, категории и жанры. Может назначать роли пользователям.
* Суперюзер Django — обладет правами администратора (admin)

## AUTH
### Регистрация пользователей и выдача токенов

#### Регистрация нового пользователя
* Получить код подтверждения на переданный email.Права доступа: Доступно без токена. Использовать имя 'me' в качестве username запрещено. Поля email и username должны быть уникальными.
#### Получение JWT-токена
* Получение JWT-токена в обмен на username и confirmation code.Права доступа: Доступно без токена.


## CATEGORIES
### Категории (типы) произведений

* Получение списка всех категорий. Права доступа: Доступно без токена
* Добавление новой категории. Права доступа: Администратор.
* Удаление категории. Права доступа: Администратор.
## GENRES
### Категории жанров

* Получение списка всех жанров. Права доступа: Доступно без токена 
* Добавление жанра. Права доступа: Администратор.
* Удаление жанра. Права доступа: Администратор.
## TITLES
### Произведения, к которым пишут отзывы (определённый фильм, книга или песенка).

* Получение списка всех произведений. Права доступа: Доступно без токена.
* Добавление произведения. Права доступа: Администратор.
* Получение информации о произведении. Права доступа: Доступно без токена.
* Частичное обновление информации о произведении. Права доступа: Администратор
* Удаление произведения. Права доступа: Администратор
## REVIEWS
### Отзывы

* Получение списка всех отзывов. Права доступа: Доступно без токена.
* Добавление нового отзыва. Пользователь может оставить только один отзыв на произведение. Права доступа: Аутентифицированные пользователи.
* Получение отзыва по id. Права доступа: Доступно без токена.
* Частичное обновление отзыва по id. Права доступа: Автор отзыва, модератор или администратор.
* Удаление отзыва по id. Права доступа: Автор отзыва, модератор или администратор.
## COMMENTS
### Комментарии к отзывам

* Получение списка всех комментариев к отзыву. Права доступа: Доступно без токена.
* Добавление комментария к отзыву. Права доступа: Аутентифицированные пользователи.
* Получение комментария к отзыву. Права доступа: Доступно без токена.
* Частичное обновление комментария к отзыву. Права доступа: Автор комментария, модератор или администратор.
* Удаление комментария к отзыву. Права доступа: Автор комментария, модератор или администратор.
## USERS
### Пользователи

* Получение списка всех пользователей. Права доступа: Администратор
* Добавление пользователя. Права доступа: Администратор
* Получение пользователя по username. Права доступа: Администратор
* Изменение данных пользователя по username. Права доступа: Администратор.
* Удаление пользователя по username. Права доступа: Администратор.
* Получение данных своей учетной записи. Права доступа: Любой авторизованный пользователь
* Изменение данных своей учетной записи. Права доступа: Любой авторизованный пользователь

# Установка:
## 1) Клонировать репозиторий и перейти в него в командной строке:

git clone https://github.com/agsharapov/api_yamdb.git
cd api_yamdb
## 2) Cоздать и активировать виртуальное окружение:

python -m venv venv
source venv/bin/activate
python -m pip install --upgrade pip
## 3) Установить зависимости из файла requirements.txt:

pip install -r requirements.txt
## 4) Выполнить миграции:

python manage.py migrate
## 5) Запустить проект:

python manage.py runserver
# Примеры запросов:
   * Получение данных своей учетной записи:    
   GET `http://127.0.0.1:8000/api/v1/users/me/`   
   
     Ответ:  
   `{
"username": "string",
"email": "user@example.com",
"first_name": "string",
"last_name": "string",
"bio": "string",
"role": "user"
}`
   * Добавление комментария к отзыву   
   POST `http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/{review_id}/comments/`    
   `{
"text": "string"
}`    
   Ответ:  
   `{
"id": 0,
"text": "string",
"author": "string",
"pub_date": "2019-08-24T14:15:22Z"
}` 

* Получение информации о произведении        
    GET `http://127.0.0.1:8000/api/v1/titles/{titles_id}/`   
     Ответ:  
   `{
"id": 0,
"name": "string",
"year": 0,
"rating": 0,
"description": "string",
"genre": [
{}
],
"category": {
"name": "string",
"slug": "string"
}
}`
* Частичное обновление отзыва по id  
    PATCH `http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/{review_id}/`   
    `{
"text": "string",
"score": 1
}`    
Ответ:  
   `
{
"id": 0,
"text": "string",
"author": "string",
"score": 1,
"pub_date": "2019-08-24T14:15:22Z"
}`


